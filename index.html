<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="Assets/style.css">
    <title>Weather Dashboard</title>
</head>

<body>
    <!-- header for weather dashboard -->
    <div class="bg-dark pt-2 pb-2"> 
        <div class="container">
            <h1 class="text-center text-white">Weather Dashboard</h1>
        </div>
    </div>

    <br>
    <!-- create a form to hold the search bar and submit button -->
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Search for a city here:</h4>
                        <form class="form-inline">
                            <div class="form-group">
                                <input type="text" class="form-control" id="citySearch" value="chicago">
                            </div>
                            <button type="submit" id="submitSearch">Submit!</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="jumbotron">
                    <h2>Current Weather in <span id="loc"></span></h2>
                    <h4>Temperature: <span id="tempF"></span></h4>
                    <h4>Wind: <span id="wind"></span></h4>
                    <h4>Humidity: <span id="humidity"></span></h4>
                </div>
            </div>
        </div>
    </div>
    <!-- place to show today's weather -->
    <div>
        <div class="weatherToday"></div>
    </div>
    <div>
        <div id="forecast"></div>
    </div>
    <!-- jQuery script -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
        </script>
    <!-- API (got some help with tutors for this script)-->
    <script>
        // global script variables
        var loc = $("#loc")
        var temp = $("#temp")
        var wind = $("#wind")
        var humidity = $("#humidity")


        //my apikey for the website 
        var apiKey = "186fe6305fa430242057e36b2d62e0f7";
        $(document).ready(
            // create click function for the api to get current and 5day forecast
            $("#submitSearch").on("click", function (e) {
                e.preventDefault()
                var userSearch = $("#citySearch").val()
                var apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${userSearch}&appid=${apiKey}`;
                var fivedayUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${userSearch}&appid=${apiKey}`;
                // $.get(apiUrl, function (res, status) {
                //     console.log(res);
                // })
                $.ajax({
                    url: apiUrl,
                    // retrieve each of these elements
                }).done(function (res) {
                    console.log(res);
                    console.log(res.name);
                    console.log(res.main.temp);
                    console.log(res.wind.speed);
                    console.log(res.main.humidity);

                    loc.text(res.name)
                    temp.text(res.main.temp)
                    wind.text(res.wind.speed)
                    humidity.text(res.main.humidity)

                    // converts the temp to fahrenheit with the below formula
                    var tempF = (res.main.temp - 273.15) * 1.80 + 32;
                    
                    $("#tempF").text("Fahrenheit " + tempF);


                });
                // another call for five-day forecast
                $.ajax({
                    url: fivedayUrl,

                }).done(function (res) {
                    console.log(res);

                    var day = res.list[0];
                    makeCard(day);


                });
                //create a card for the elements
                function makeCard(day) {
                    var div = $("<div>")
                    // var date = $("<p>")
                    var temperature = $("<p>").text(day.main.temp)
                    var wind = $("<p>").text(day.wind.speed)
                    var humidity = $("<p>").text(day.main.humidity)
                    div.append(temperature, wind, humidity)
                    $("#forecast").append(div)
                }
            })
        )
    </script>


</body>

</html>